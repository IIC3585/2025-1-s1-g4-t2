(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const g of o.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&r(g)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();let s,p=null;function I(){return(p===null||p.byteLength===0)&&(p=new Uint8Array(s.memory.buffer)),p}let d=0;function m(e,t){const i=t(e.length*1,1)>>>0;return I().set(e,i/1),d=e.length,i}function y(e,t){return e=e>>>0,I().subarray(e/1,e/1+t)}function U(e,t,i){const r=m(e,s.__wbindgen_malloc),n=d,o=s.resize(r,n,t,i);var g=y(o[0],o[1]).slice();return s.__wbindgen_free(o[0],o[1]*1,1),g}function E(e){const t=m(e,s.__wbindgen_malloc),i=d,r=s.grayscale(t,i);var n=y(r[0],r[1]).slice();return s.__wbindgen_free(r[0],r[1]*1,1),n}function R(e,t){const i=m(e,s.__wbindgen_malloc),r=d,n=s.blur(i,r,t);var o=y(n[0],n[1]).slice();return s.__wbindgen_free(n[0],n[1]*1,1),o}function A(e){const t=m(e,s.__wbindgen_malloc),i=d,r=s.invert(t,i);var n=y(r[0],r[1]).slice();return s.__wbindgen_free(r[0],r[1]*1,1),n}function B(e,t){const i=m(e,s.__wbindgen_malloc),r=d,n=s.brighten(i,r,t);var o=y(n[0],n[1]).slice();return s.__wbindgen_free(n[0],n[1]*1,1),o}function O(e){const t=m(e,s.__wbindgen_malloc),i=d,r=s.flip_horizontal(t,i);var n=y(r[0],r[1]).slice();return s.__wbindgen_free(r[0],r[1]*1,1),n}function S(e){const t=m(e,s.__wbindgen_malloc),i=d,r=s.rotate90(t,i);var n=y(r[0],r[1]).slice();return s.__wbindgen_free(r[0],r[1]*1,1),n}async function W(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const i=await e.arrayBuffer();return await WebAssembly.instantiate(i,t)}else{const i=await WebAssembly.instantiate(e,t);return i instanceof WebAssembly.Instance?{instance:i,module:e}:i}}function x(){const e={};return e.wbg={},e.wbg.__wbindgen_init_externref_table=function(){const t=s.__wbindgen_export_0,i=t.grow(4);t.set(0,void 0),t.set(i+0,void 0),t.set(i+1,null),t.set(i+2,!0),t.set(i+3,!1)},e}function N(e,t){return s=e.exports,L.__wbindgen_wasm_module=t,p=null,s.__wbindgen_start(),s}async function L(e){if(s!==void 0)return s;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL("/2025-1-s1-g4-t2/assets/img_processor_bg-DI6vp1eK.wasm",import.meta.url));const t=x();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:i,module:r}=await W(await e,t);return N(i,r)}const j="/2025-1-s1-g4-t2/assets/img_processor_bg-DI6vp1eK.wasm";async function k(){const e=await fetch(j);await L(await e.arrayBuffer());const t=document.getElementById("imageInput"),i=document.getElementById("preview"),r=document.getElementById("applyFilter"),n=document.getElementById("filterSelect"),o=document.getElementById("resultCanvas"),g=o.getContext("2d");let l=null,w=null,_;const v=window.indexedDB.open("ImageDatabase",1);v.onerror=function(c){console.error("IndexedDB error:",c)},v.onupgradeneeded=function(c){_=c.target.result,_.createObjectStore("images",{autoIncrement:!0})},v.onsuccess=function(c){_=c.target.result},t.addEventListener("change",async c=>{const a=c.target.files[0];if(a){const f=URL.createObjectURL(a);i.src=f,i.style.display="block";const u=await a.arrayBuffer();l=new Uint8Array(u)}}),r.addEventListener("click",async()=>{if(!l){alert("Seleccione una imagen primero.");return}const c=n.value;let a;try{switch(c){case"resize":a=U(l,200,200);break;case"grayscale":a=E(l);break;case"blur":a=R(l,5);break;case"invert":a=A(l);break;case"brighten":a=B(l,30);break;case"flip_horizontal":a=O(l);break;case"rotate90":a=S(l);break;default:alert("Seleccione un filtro válido.");return}const f=new Blob([a],{type:"image/png"});w=f;const u=URL.createObjectURL(f),b=new Image;b.onload=function(){o.width=b.width,o.height=b.height,g.drawImage(b,0,0),URL.revokeObjectURL(u)},b.src=u,Notification.permission==="granted"?new Notification("Imagen procesada",{body:"El filtro se aplicó con éxito."}):Notification.permission!=="denied"&&Notification.requestPermission().then(h=>{h==="granted"&&new Notification("Imagen procesada",{body:"El filtro se aplicó con éxito."})})}catch(f){console.error(f)}}),document.getElementById("saveImage").addEventListener("click",()=>{if(!w){alert("No hay imagen procesada para guardar.");return}const f=_.transaction(["images"],"readwrite").objectStore("images").add(w);f.onsuccess=function(){alert("Imagen guardada en IndexedDB.")},f.onerror=function(h){console.error("Error al guardar:",h)};const u=document.createElement("a"),b=URL.createObjectURL(w);u.href=b,u.download="processed_image.png",u.click()})}k();
